<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>radlib_fillin_collection.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="analytics.html">analytics.rb</a>
          <a class="source" href="document_store.html">document_store.rb</a>
          <a class="source" href="error_codes.html">error_codes.rb</a>
          <a class="source" href="model_global.html">model_global.rb</a>
          <a class="source" href="model_validations.html">model_validations.rb</a>
          <a class="source" href="radlib_fillin.html">radlib_fillin.rb</a>
          <a class="source" href="radlib_fillin_collection.html">radlib_fillin_collection.rb</a>
          <a class="source" href="radlib_story.html">radlib_story.rb</a>
          <a class="source" href="radlib_text_array.html">radlib_text_array.rb</a>
          <a class="source" href="radlibs_base.html">radlibs_base.rb</a>
          <a class="source" href="user.html">user.rb</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>radlib_fillin_collection.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        <p>Author:: Couchbase <a href="mailto:info@couchbase.com">info@couchbase.com</a>
Copyright:: 2012 Couchbase, Inc.
License:: Apache License, Version 2.0</p>

<p>Licensed under the Apache License, Version 2.0 (the &ldquo;License&rdquo;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<pre><code>http://www.apache.org/licenses/LICENSE-2.0
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &ldquo;AS IS&rdquo; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">class</span> <span class="nc">RadlibFillinCollection</span> <span class="o">&lt;</span> <span class="no">RadlibsBase</span>
  <span class="kp">include</span> <span class="no">DocumentStore</span>
  <span class="kp">include</span> <span class="no">ModelValidations</span>
  <span class="kp">include</span> <span class="no">ModelGlobal</span>
  <span class="kp">include</span> <span class="no">ErrorCodes</span>

  <span class="kp">attr_accessor</span> <span class="ss">:radlib_id</span><span class="p">,</span> <span class="ss">:radlib</span><span class="p">,</span> <span class="ss">:fillins</span><span class="p">,</span> <span class="ss">:num_fillins</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="kp">attr</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="k">super</span>

    <span class="vi">@fillins</span> <span class="o">=</span> <span class="o">[]</span>

    <span class="k">if</span> <span class="kp">attr</span><span class="o">.</span><span class="n">has_key_and_value?</span><span class="p">(</span><span class="ss">:radlib_id</span><span class="p">)</span>
      <span class="vi">@radlib</span> <span class="o">=</span> <span class="n">find_radlib_by_radlib_id</span><span class="p">(</span><span class="kp">attr</span><span class="o">[</span><span class="ss">:radlib_id</span><span class="o">]</span><span class="p">)</span>

      <span class="k">raise</span> <span class="no">ArgumentError</span><span class="p">,</span> <span class="s2">&quot;RadlibID not found&quot;</span> <span class="k">unless</span> <span class="vi">@radlib</span>

      <span class="vi">@radlib_id</span> <span class="o">=</span> <span class="vi">@radlib</span><span class="o">.</span><span class="n">radlib_id</span>
      <span class="vi">@num_fillins</span> <span class="o">=</span> <span class="vi">@radlib</span><span class="o">.</span><span class="n">num_fillins</span>
      <span class="n">retrieve_fillins</span> <span class="k">if</span> <span class="vi">@num_fillins</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">end</span>
    <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">intense_yellow</span><span class="p">(</span><span class="s2">&quot;---------------------------------------------------------------------------------------------------------------------------------------------------------------&quot;</span><span class="p">))</span>

    <span class="vi">@fillins</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">entry</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;INDEX: [</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;USER: [</span><span class="si">#{</span><span class="n">entry</span><span class="o">[</span><span class="ss">:user</span><span class="o">].</span><span class="n">firstname</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ID: [</span><span class="si">#{</span><span class="n">entry</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ENTRY OBJ ID: </span><span class="si">#{</span><span class="n">entry</span><span class="o">[</span><span class="ss">:user_inputs</span><span class="o">].</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
      <span class="n">entry</span><span class="o">[</span><span class="ss">:user_inputs</span><span class="o">].</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">w</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="o">[</span><span class="s2">&quot;selected&quot;</span><span class="o">]</span><span class="p">)</span>
          <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">object_id</span><span class="p">)</span>
          <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">inspect</span><span class="p">)</span>
          <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">#{</span><span class="n">w</span><span class="o">[</span><span class="s2">&quot;text&quot;</span><span class="o">]</span><span class="si">}</span><span class="s2"> replaced by </span><span class="si">#{</span><span class="n">w</span><span class="o">[</span><span class="s2">&quot;fillin_word&quot;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
          <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">intense_yellow</span><span class="p">(</span><span class="s2">&quot;---------------------------------------------------------------------------------------------------------------------------------------------------------------&quot;</span><span class="p">))</span>
    <span class="k">end</span>

  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">retrieve_fillins</span></pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-2">&#182;</a>
        </div>
        <p>generate all the keys</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">key_array</span> <span class="o">=</span> <span class="o">[]</span>
    <span class="vi">@num_fillins</span><span class="o">.</span><span class="n">downto</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
      <span class="n">key_array</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;radfill::</span><span class="si">#{</span><span class="vi">@radlib_id</span><span class="si">}</span><span class="s2">::</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>retrieve all the fillins</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">fillins</span> <span class="o">=</span> <span class="n">get_documents</span><span class="p">(</span><span class="n">key_array</span><span class="p">)</span>

    <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key_array</span><span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>if there is only one fillin, it will come back as a Hash (the one fillin), otherwise it will be an array of Hashes</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">if</span> <span class="n">fillins</span><span class="o">.</span><span class="n">is_a?</span> <span class="no">Hash</span>
      <span class="n">add_to_user_entries</span><span class="p">(</span><span class="n">fillins</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">fillins</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">fillin</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
        <span class="n">add_to_user_entries</span><span class="p">(</span><span class="n">fillin</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>Rails.logger.debug(@user_entries)</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">add_to_user_entries</span><span class="p">(</span><span class="n">fillin_hash</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">fillin_hash</span><span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-6">&#182;</a>
        </div>
        <p>Get the User info for the user who filled in the Radlib</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">fillin_user</span> <span class="o">=</span> <span class="n">find_user_by_uid</span><span class="p">(</span><span class="n">fillin_hash</span><span class="o">[</span><span class="s2">&quot;uid&quot;</span><span class="o">].</span><span class="n">to_i</span><span class="p">)</span>
    <span class="n">radlib_fillin_id</span> <span class="o">=</span> <span class="s2">&quot;radfill::</span><span class="si">#{</span><span class="n">fillin_hash</span><span class="o">[</span><span class="s2">&quot;radlib_id&quot;</span><span class="o">]</span><span class="si">}</span><span class="s2">::</span><span class="si">#{</span><span class="n">fillin_hash</span><span class="o">[</span><span class="s2">&quot;fillin_index&quot;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">comment_count_key</span> <span class="o">=</span> <span class="n">radlib_fillin_id</span> <span class="o">+</span> <span class="s2">&quot;::comment_count&quot;</span>
    <span class="n">views_count_key</span> <span class="o">=</span> <span class="n">radlib_fillin_id</span> <span class="o">+</span> <span class="s2">&quot;::views&quot;</span>
    <span class="n">likes_count_key</span> <span class="o">=</span> <span class="n">radlib_fillin_id</span> <span class="o">+</span> <span class="s2">&quot;::likes&quot;</span>

    <span class="n">initialize_document</span><span class="p">(</span><span class="n">comment_count_key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">initialize_document</span><span class="p">(</span><span class="n">views_count_key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">initialize_document</span><span class="p">(</span><span class="n">likes_count_key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">comment_count</span> <span class="o">=</span> <span class="n">get_document</span><span class="p">(</span><span class="n">comment_count_key</span><span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <p>Copy the radlib text array for merging information into</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">radlib_text_array_copy</span> <span class="o">=</span> <span class="vi">@radlib</span><span class="o">.</span><span class="n">radlib_text_array</span><span class="o">.</span><span class="n">dup</span></pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-8">&#182;</a>
        </div>
        <p>Setup the Fillin object that&rsquo;s pushed into the collection</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">user_entry</span> <span class="o">=</span> <span class="p">{</span>
        <span class="ss">:id</span> <span class="o">=&gt;</span> <span class="n">radlib_fillin_id</span><span class="p">,</span>
        <span class="ss">:user</span> <span class="o">=&gt;</span> <span class="n">fillin_user</span><span class="p">,</span>
        <span class="ss">:user_inputs</span> <span class="o">=&gt;</span> <span class="n">radlib_text_array_copy</span><span class="p">,</span>
        <span class="ss">:comment_count</span> <span class="o">=&gt;</span> <span class="n">comment_count</span><span class="p">,</span>
        <span class="ss">:views_count</span> <span class="o">=&gt;</span> <span class="n">get_document</span><span class="p">(</span><span class="n">views_count_key</span><span class="p">),</span>
        <span class="ss">:likes_count</span> <span class="o">=&gt;</span> <span class="n">get_document</span><span class="p">(</span><span class="n">likes_count_key</span><span class="p">)</span>
    <span class="p">}</span></pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-9">&#182;</a>
        </div>
        <p>Get the User inputs array to iterate through and merge into radlib<em>text</em>array</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">user_inputs_array</span> <span class="o">=</span> <span class="n">fillin_hash</span><span class="o">[</span><span class="s2">&quot;user_inputs&quot;</span><span class="o">]</span></pre></div>
      </td>
    </tr>
    <tr id='section-10'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-10">&#182;</a>
        </div>
        <p>for each user<em>input, set the radlib</em>text_array at that index to the user input value</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">user_inputs_array</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">input</span><span class="o">|</span></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p>Duplicate this hash or it will have the same object_id</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="n">user_entry</span><span class="o">[</span><span class="ss">:user_inputs</span><span class="o">][</span><span class="n">input</span><span class="o">[</span><span class="s2">&quot;radlib_text_array_index&quot;</span><span class="o">]]</span> <span class="o">=</span> <span class="n">user_entry</span><span class="o">[</span><span class="ss">:user_inputs</span><span class="o">][</span><span class="n">input</span><span class="o">[</span><span class="s2">&quot;radlib_text_array_index&quot;</span><span class="o">]].</span><span class="n">dup</span></pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-12">&#182;</a>
        </div>
        <p>Set the fillin_word</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="n">user_entry</span><span class="o">[</span><span class="ss">:user_inputs</span><span class="o">][</span><span class="n">input</span><span class="o">[</span><span class="s2">&quot;radlib_text_array_index&quot;</span><span class="o">]][</span><span class="s2">&quot;fillin_word&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">input</span><span class="o">[</span><span class="s2">&quot;fillin_word&quot;</span><span class="o">]</span></pre></div>
      </td>
    </tr>
    <tr id='section-13'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-13">&#182;</a>
        </div>
        <p>Rails.logger.debug(intense<em>blue(&ldquo;user</em>entry[:user<em>inputs][#{input[&quot;radlib</em>text<em>array</em>index&rdquo;]}][\&ldquo;fillin<em>word\&rdquo;] = #{input[&ldquo;fillin</em>word&rdquo;]}&ldquo;))</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">end</span>

    <span class="n">recent_comments</span> <span class="o">=</span> <span class="o">[]</span></pre></div>
      </td>
    </tr>
    <tr id='section-14'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-14">&#182;</a>
        </div>
        <p>get recent comments</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">if</span> <span class="n">comment_count</span> <span class="o">&gt;</span> <span class="mi">0</span>

      <span class="n">comment_key_array</span> <span class="o">=</span> <span class="o">[]</span>
      <span class="n">comment_end_index</span> <span class="o">=</span> <span class="n">comment_count</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="o">?</span> <span class="n">comment_count</span> <span class="o">-</span> <span class="mi">4</span> <span class="p">:</span> <span class="mi">1</span>

      <span class="n">comment_count</span><span class="o">.</span><span class="n">downto</span><span class="p">(</span><span class="n">comment_end_index</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
        <span class="n">comment_key_array</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">radlib_fillin_id</span><span class="si">}</span><span class="s2">::comment::</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">comment_key_array</span><span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-15'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-15">&#182;</a>
        </div>
        <p>retrieve all the recent comments</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="n">recent_comments</span> <span class="o">=</span> <span class="n">get_documents</span><span class="p">(</span><span class="n">comment_key_array</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">recent_comments</span><span class="o">.</span><span class="n">is_a?</span> <span class="no">Hash</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">recent_comments</span>
        <span class="n">recent_comments</span> <span class="o">=</span> <span class="o">[]</span>
        <span class="n">recent_comments</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="no">Map</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">recent_comments</span><span class="o">.</span><span class="n">inspect</span><span class="p">)</span>
      <span class="n">recent_comments</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">comment</span><span class="o">|</span>
        <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">comment</span><span class="o">.</span><span class="n">inspect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span>
          <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">comment</span><span class="o">[</span><span class="ss">:author</span><span class="o">].</span><span class="n">to_s</span><span class="p">)</span>
          <span class="n">author</span> <span class="o">=</span> <span class="n">find_user_by_uid</span><span class="p">(</span><span class="n">comment</span><span class="o">[</span><span class="ss">:author</span><span class="o">]</span><span class="p">)</span>
          <span class="n">comment</span><span class="o">[</span><span class="ss">:author_name</span><span class="o">]</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">firstname</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">author</span><span class="o">.</span><span class="n">lastname</span>
          <span class="n">comment</span><span class="o">[</span><span class="ss">:author_profile_img</span><span class="o">]</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">fb_img_square</span>
        <span class="k">end</span>
      <span class="k">end</span>

    <span class="k">end</span>

    <span class="n">user_entry</span><span class="o">[</span><span class="ss">:recent_comments</span><span class="o">]</span> <span class="o">=</span> <span class="n">recent_comments</span></pre></div>
      </td>
    </tr>
    <tr id='section-16'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-16">&#182;</a>
        </div>
        <p>DEBUG OUTPUT</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">user_entry</span><span class="o">[</span><span class="ss">:user_inputs</span><span class="o">].</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">w</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="o">[</span><span class="s2">&quot;selected&quot;</span><span class="o">]</span><span class="p">)</span>
        <span class="no">Rails</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="s2">] = </span><span class="si">#{</span><span class="n">w</span><span class="o">[</span><span class="s2">&quot;fillin_word&quot;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>



    <span class="vi">@fillins</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="n">user_entry</span>
  <span class="k">end</span>

<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
